<div class="row">
    <div class="col-sm-12">
        <div class="no-border pull-left">
            <a  ng-if="canCreate" href="#/dialer/new?domain={{domain}}" ng-disabled="!domain" style="padding: 0" class="btn btn-icon btn-icon-round btn-icon-sm  btn-gap-v bg-success">
                <i class="fa fa-plus"></i>
            </a>

            <a ng-click="reloadData()" ng-disabled="!domain" style="padding: 0" class="btn btn-icon btn-icon-round btn-icon-sm  btn-gap-v bg-primary">
                <i class="glyphicon glyphicon-refresh"></i>
            </a>
        </div>
    </div>
</div>

<div class="table-responsive" style="position: relative;">
    <div ng-show="isLoading" class="loading text-center">
        <span>
            <i class="fa fa-spinner fa-5x fa-spin"></i>
        </span>
    </div>

    <table st-pipe="callServer" st-table="membersRowCollection"
           infinite-scroll-disabled="isLoading"
           infinite-scroll="callServer"
           wt-responsive-table
           class="table table-bordered">
        <thead>
        <tr>
            <th st-skip-natural="true" rowspan=2 st-sort="name" >Name</th>
            <th st-skip-natural="true" rowspan=2 st-sort="priority" >Priority</th>
            <th st-skip-natural="true" rowspan=2 st-sort="timezone" >timezone</th>
            <th st-skip-natural="true" colspan=4 >Communications</th>
            <th                        rowspan=2>Action</th>
        </tr>
        <tr>
            <td>number</td>
            <td>priority</td>
            <td>status</td>
            <td>state</td>
        </tr>

        <tr>
            <th colspan="1"><input st-search="name" class="form-control" placeholder="start with..." type="search"/></th>
            <th colspan="1"><input st-search="priority" class="form-control" placeholder="global search ..." type="text"/></th>
            <th colspan="1"><input st-search="timezone" class="form-control" placeholder="global search ..." type="text"/></th>
            <th colspan="1"><input st-search="communications_number" class="form-control" placeholder="global search ..." type="text"/></th>
            <th colspan="1"><input st-search="communications_priority" class="form-control" placeholder="global search ..." type="text"/></th>
            <th colspan="1">
                <select st-search="communications_status" class="form-control">
                    <option value="">All</option>
                    <option ng-repeat="comStatus in CommunicationStatuses" value="{{comStatus.val}}">{{comStatus.name}}</option>
                </select>
            </th>
            <th colspan="1">
                <select st-search="communications_state" class="form-control">
                    <option value="">All</option>
                    <option ng-repeat="comState in CommunicationStates" value="{{comState.val}}">{{comState.name}}</option>
                </select>
            </th>
            <th></th>
        </tr>
        <tr ng-show="membersRowCollection.length <= 0">
            <th colspan="8">
                <div class="row text-center">
                    <div class="center-block col-md-4" style="float: none;">
                        <h1 aria-hidden="true"><i aria-hidden="true" class="fa fa-meh-o"></i></h1>
                        <h2>No results found</h2>
                    </div>
                </div>
            </th>
        </tr>
        </thead>

        <tbody ng-show="membersRowCollection.length > 0" ng-repeat="t in membersRowCollection">
        <tr>
            <td rowspan="{{t.communications.length}}">{{t.name}}</td>
            <td rowspan="{{t.communications.length}}">{{t.priority}}</td>
            <td rowspan="{{t.communications.length}}">{{t.timezone}}</td>
            <td>{{t.communications[0].number}}</td>
            <td>{{t.communications[0].priority}}</td>
            <td>{{t.communications[0].status}}</td>
            <td>{{t.communications[0].state}}</td>
            <td rowspan="{{t.communications.length}}">ACTION</td>
        </tr>
        <tr ng-repeat="item in t.communications" ng-if="$index > 0">
            <td>{{item.number}}</td>
            <td>{{item.priority}}</td>
            <td>{{item.status}}</td>
            <td>{{item.state}}</td>
        </tr>


        </tbody>

        <tfoot>
        <tr>
            <td class="text-center" st-pagination="" st-items-by-page="CountItemsByPage" colspan="8">
            </td>
        </tr>
        </tfoot>
    </table>

</div>